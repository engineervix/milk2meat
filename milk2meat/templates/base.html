{% load static %}
<!DOCTYPE html>
{% comment "We ignore these rules here as they are handled in child templates" %}
    * H030 = Consider adding a meta description.
    * H031 = Consider adding meta keywords.
{% endcomment %}
{# djlint:off H030,H031 #}
<html lang="en" class="h-full">
    <head>
        <!-- Prevent theme flicker by setting theme immediately -->
        <script>
            (function() {
                // Get the saved theme from localStorage
                var savedTheme = localStorage.getItem('milk2meat-theme');

                // If there's a saved theme, apply it immediately
                if (savedTheme) {
                    document.documentElement.setAttribute('data-theme', savedTheme);
                } else {
                    // Check for system preference if no saved theme
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        document.documentElement.setAttribute('data-theme', 'night');
                    } else {
                        document.documentElement.setAttribute('data-theme', 'winter');
                    }
                }
            })();
        </script>
        {# You can add your analytics here #}
        <title>
            {% block title %}
                {% block title_prefix %}
                    Milk2Meat Â»
                {% endblock title_prefix %}
                {{ page.title }}
                {% block title_suffix %}
                {% endblock title_suffix %}
            {% endblock title %}
        </title>
        {% if not debug %}
            {# Umami Analytics #}
            {% if SEO_NOINDEX %}
                {# staging #}
                <script defer
                        src="https://analytics.umusebo.com/script.js"
                        data-website-id="some-id"></script>
            {% else %}
                {# production #}
                <script defer
                        src="https://analytics.umusebo.com/script.js"
                        data-website-id="some-id"></script>
            {% endif %}
        {% endif %}
        {% comment %}
            To prevent _most_ search engines from indexing the site
            https://developers.google.com/search/docs/crawling-indexing/block-indexing
        {% endcomment %}
        {% if SEO_NOINDEX or request.get_host != request.site.hostname %}<meta name="robots" content="noindex" />{% endif %}
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport"
              content="width=device-width, initial-scale=1, shrink-to-fit=no">
        {% if request.in_preview_panel %}<base target="_blank">{% endif %}
        {% block extrameta %}
        {% endblock extrameta %}
        {# Favicons, generated by http://favicon.io/ #}
        <link rel="apple-touch-icon"
              sizes="180x180"
              href="{% static 'ico/apple-touch-icon.png' %}">
        <link rel="icon"
              type="image/png"
              sizes="32x32"
              href="{% static 'ico/favicon-32x32.png' %}">
        <link rel="icon"
              type="image/png"
              sizes="16x16"
              href="{% static 'ico/favicon-16x16.png' %}">
        <link rel="manifest" href="{% static 'ico/site.webmanifest' %}">
        {# Vendor stylesheets can be added here #}
        {# Main Stylesheet #}
        <link href="{% static 'css/main.min.css' %}" rel="stylesheet">
        {% block extra_css %}
            {# Override this in templates to add extra stylesheets #}
        {% endblock extra_css %}
        {% load humanize %}
    </head>
    {# djlint:on #}
    <body class="{% block body_class %}flex flex-col min-h-screen{% endblock body_class %}">
        {% include "components/messages.html" %}

        {% block navbar %}
            {% include "components/navbar.html" %}
        {% endblock navbar %}

        <header class="{% block header_class %}{% endblock header_class %}">
            {% block promo_block %}
            {% endblock promo_block %}
        </header>

        <main class="flex-grow">
            {% block content %}
            {% endblock content %}
        </main>

        {% block footer %}
            {% include "components/footer.html" %}
        {% endblock footer %}

        {# Vendor scripts can be added here #}
        {# Main Script #}
        <script src="{% static 'js/main.min.js' %}"></script>

        {# Blueletter Bible #}
        <script src='https://www.blueletterbible.org/assets-v3/scripts/blbToolTip/BLB_ScriptTagger-min.js'
                type='text/javascript'></script>
        <script type='text/javascript'>
            // Additional settings
            BLB.Tagger.Translation = 'ESV';
            BLB.Tagger.HyperLinks = 'all'; // 'all', 'none', 'hover'
            BLB.Tagger.HideTanslationAbbrev = false;
            BLB.Tagger.TargetNewWindow = true;
            BLB.Tagger.Style = 'par'; // 'line' or 'par'
            BLB.Tagger.NoSearchTagNames = ''; // HTML element list
            BLB.Tagger.NoSearchClassNames = 'noTag doNotTag'; // CSS class list
        </script>

        {% block extra_js %}
        {% endblock extra_js %}
    </body>
</html>
